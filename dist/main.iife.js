!function(){"use strict";(()=>{const e=document.querySelector(".custom-cursor");if(!e)return;const t="https://cdn.prod.website-files.com/68f62fcbc64d17f90e046dfa/6905079459f55e8c6f5dcfbb_cursor-interact.avif",n="https://cdn.prod.website-files.com/68f62fcbc64d17f90e046dfa/690507948080bd9a825974f5_cursor-auto.avif";e.style.backgroundImage=`url(${t})`,e.style.willChange="transform",e.style.transform="translate3d(0, 0, 0)";let r=null,i=0,o=0;function a(){e.style.transform=`translate3d(${i}px, ${o}px, 0)`,r=null}document.addEventListener("mousemove",e=>{i=e.clientX,o=e.clientY+2,r||(r=requestAnimationFrame(a))},{passive:!0});const s='a, button, .articles_cms_radio, input[type="submit"], input[type="button"], input[type="radio"], input[type="checkbox"], select, textarea, .clickable, [onclick], .w-button, .w-nav-link, .w-tab-link, .w-dropdown-toggle, .w-dropdown-link, .w-slider-arrow-left, .w-slider-arrow-right, .w-slider-dot, .w-pagination-previous, .w-pagination-next, .w-radio, .w-form-label, .bunny-player__big-btn, .bunny-player__playpause',l=new WeakSet;let d=null;function u(){document.querySelectorAll(s).forEach(r=>{l.has(r)||(l.add(r),r.addEventListener("mouseenter",()=>{e.style.backgroundImage=`url(${n})`},{passive:!0}),r.addEventListener("mouseleave",()=>{e.style.backgroundImage=`url(${t})`},{passive:!0}))})}if(u(),document.addEventListener("mouseover",t=>{var r;const i=t.target,o=null==(r=null==i?void 0:i.closest)?void 0:r.call(i,s);o&&(l.has(o)||u(),e.style.backgroundImage=`url(${n})`)},{passive:!0}),document.addEventListener("mouseout",n=>{var r,i;const o=n.target,a=n.relatedTarget,l=null==(r=null==o?void 0:o.closest)?void 0:r.call(o,s),d=null==(i=null==a?void 0:a.closest)?void 0:i.call(a,s);l&&!d&&(e.style.backgroundImage=`url(${t})`)},{passive:!0}),"undefined"!=typeof MutationObserver){new MutationObserver(()=>{d||(d=setTimeout(()=>{u(),d=null},100))}).observe(document.body,{childList:!0,subtree:!0})}})(),(()=>{function e(){const e=document.querySelector(".nav_1_btn_wrap"),t=document.querySelector(".nav_hamburguer-menu"),n=document.querySelector(".nav_hamburguer-exit");if(!e)return;if(!t||!n)return;function r(){e.classList.contains("w--open")||null!==document.querySelector(".w-nav-menu.w--open")||null!==document.querySelector(".w-nav-overlay.w--open")?(t.style.display="none",n.style.display="block"):(t.style.display="block",n.style.display="none")}r();const i=new MutationObserver(r);i.observe(e,{attributes:!0,attributeFilter:["class"]});const o=document.querySelector(".w-nav-overlay");if(o){new MutationObserver(r).observe(o,{attributes:!0,attributeFilter:["class"]})}const a=document.querySelector(".w-nav-menu");if(a){new MutationObserver(r).observe(a,{attributes:!0,attributeFilter:["class"]})}window.addEventListener("beforeunload",()=>{i.disconnect()})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()})(),(()=>{function e(){if("undefined"==typeof THREE)return;const e=()=>window.innerWidth<768,t={scanlineOpacity:.07,scanlineCount:2e3,barrelPower:1.006,barrelPowerMobile:1,vignetteStrength:.5,vignetteStrengthMobile:0,vignetteRadius:.7,vignetteRadiusMobile:0,beamIntensity:0,beamSpeed:0,glowSize:0,noiseAmount:.03,flickerAmount:.004,chromaticAberration:.1,brightness:1},n=new THREE.WebGLRenderer({alpha:!0,premultipliedAlpha:!1,antialias:!1});n.setSize(window.innerWidth,window.innerHeight),n.setPixelRatio(Math.min(window.devicePixelRatio,2)),n.setClearColor(0,0),n.domElement.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n      z-index: 999999;\n    ",document.body.appendChild(n.domElement);const r=new THREE.Scene,i=new THREE.OrthographicCamera(-1,1,1,-1,0,1),o=new THREE.ShaderMaterial({uniforms:{time:{value:0},resolution:{value:new THREE.Vector2(window.innerWidth,window.innerHeight)},scanlineOpacity:{value:t.scanlineOpacity},scanlineCount:{value:t.scanlineCount},barrelPower:{value:e()?t.barrelPowerMobile:t.barrelPower},vignetteStrength:{value:t.vignetteStrength},vignetteRadius:{value:t.vignetteRadius},beamIntensity:{value:t.beamIntensity},beamSpeed:{value:t.beamSpeed},glowSize:{value:t.glowSize},noiseAmount:{value:t.noiseAmount},flickerAmount:{value:t.flickerAmount},chromaticAberration:{value:t.chromaticAberration},brightness:{value:t.brightness}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n      precision highp float;\n\n      uniform float time;\n      uniform vec2 resolution;\n      uniform float scanlineOpacity;\n      uniform float scanlineCount;\n      uniform float barrelPower;\n      uniform float vignetteStrength;\n      uniform float vignetteRadius;\n      uniform float beamIntensity;\n      uniform float beamSpeed;\n      uniform float glowSize;\n      uniform float noiseAmount;\n      uniform float flickerAmount;\n      uniform float chromaticAberration;\n      uniform float brightness;\n\n      varying vec2 vUv;\n\n      vec2 barrelDistortion(vec2 coord, float power) {\n        vec2 cc = coord - 0.5;\n        float dist = dot(cc, cc);\n        return coord + cc * dist * power;\n      }\n\n      float noise(vec2 p) {\n        return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453123);\n      }\n\n      float smoothNoise(vec2 p) {\n        vec2 i = floor(p);\n        vec2 f = fract(p);\n        f = f * f * (3.0 - 2.0 * f);\n\n        float a = noise(i);\n        float b = noise(i + vec2(1.0, 0.0));\n        float c = noise(i + vec2(0.0, 1.0));\n        float d = noise(i + vec2(1.0, 1.0));\n\n        return mix(mix(a, b, f.x), mix(c, d, f.x), f.y);\n      }\n\n      void main() {\n        vec2 uv = vUv;\n        vec2 distortedUV = barrelDistortion(uv, barrelPower - 1.0);\n\n        float edge = 0.0;\n        if (distortedUV.x < 0.0 || distortedUV.x > 1.0 ||\n            distortedUV.y < 0.0 || distortedUV.y > 1.0) {\n          edge = 1.0;\n        }\n\n        float scanline = sin(distortedUV.y * scanlineCount) * scanlineOpacity;\n\n        float beamPos = mod(time * beamSpeed, 1.0);\n        float beamDist = abs(distortedUV.y - beamPos);\n        float beam = smoothstep(glowSize, 0.0, beamDist) * beamIntensity;\n        float beamTrail = smoothstep(glowSize * 2.5, glowSize * 0.5, beamDist) * beamIntensity * 0.2;\n\n        float staticNoise = smoothNoise(distortedUV * 800.0 + time * 5.0) * noiseAmount;\n\n        vec2 position = distortedUV - 0.5;\n        float dist = length(position);\n        float vignette = smoothstep(vignetteRadius, vignetteRadius - 0.3, dist);\n        float edgeVignette = smoothstep(0.5, 0.7, dist) * vignetteStrength;\n\n        float flicker = sin(time * 100.0) * flickerAmount;\n\n        float darkness = 0.0;\n        darkness += scanline;\n        darkness += beam + beamTrail;\n        darkness += staticNoise;\n        darkness += edgeVignette;\n        darkness += flicker;\n\n        darkness *= vignette;\n        darkness = mix(darkness, 1.0, edge);\n        darkness *= brightness;\n\n          gl_FragColor = vec4(0.0, 0.0, 0.0, darkness);\n      }\n      ",transparent:!0,blending:THREE.NormalBlending,depthTest:!1,depthWrite:!1}),a=new THREE.PlaneGeometry(2,2),s=new THREE.Mesh(a,o);r.add(s),window.addEventListener("resize",function(){const r=window.innerWidth,i=window.innerHeight;n.setSize(r,i),o.uniforms.resolution.value.set(r,i),o.uniforms.barrelPower.value=e()?t.barrelPowerMobile:t.barrelPower}),function e(t){o.uniforms.time.value=.001*t,n.render(r,i),requestAnimationFrame(e)}(0),window.crtConfig=t,window.updateCRT=()=>{Object.keys(t).forEach(e=>{o.uniforms[e]&&(o.uniforms[e].value=t[e])}),o.uniforms.barrelPower.value=e()?t.barrelPowerMobile:t.barrelPower}}window.requestIdleCallback?requestIdleCallback(e,{timeout:2e3}):"complete"===document.readyState?setTimeout(e,100):window.addEventListener("load",()=>setTimeout(e,100))})(),window.addEventListener("load",()=>{if("undefined"==typeof gsap||"undefined"==typeof ScrollTrigger)return;const e=document.querySelectorAll("[data-pixelate-img]");function t(e){const t=e.parentElement;if(!t)return;const n=document.createElement("canvas"),r=n.getContext("2d",{willReadFrequently:!1}),i=2e3;let o=e.naturalWidth,a=e.naturalHeight;if(o>i||a>i){const e=Math.min(i/o,i/a);o=Math.floor(o*e),a=Math.floor(a*e)}n.width=o,n.height=a,Object.assign(n.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",objectFit:"cover",zIndex:"2"}),"static"===getComputedStyle(t).position&&(t.style.position="relative"),e.style.opacity="0",t.appendChild(n);const s=[40,15,5,1];d(s[0]);const l=gsap.timeline({scrollTrigger:{trigger:t,start:"top 80%",toggleActions:"play none none none"}});function d(t){const i=n.width,o=n.height;r.imageSmoothingEnabled=!1,r.clearRect(0,0,i,o);const a=Math.max(1,Math.ceil(i/t)),s=Math.max(1,Math.ceil(o/t)),l=document.createElement("canvas"),d=l.getContext("2d");l.width=a,l.height=s,d.drawImage(e,0,0,a,s),r.drawImage(l,0,0,i,o)}s.forEach((e,t)=>{l.call(()=>d(e),null,.1*t)}),l.call(()=>{n.remove(),e.style.opacity="1"})}0!==e.length&&e.forEach(e=>{e.complete&&e.naturalWidth>0?t(e):e.addEventListener("load",()=>t(e))})}),window.addEventListener("DOMContentLoaded",()=>{"undefined"!=typeof gsap&&"undefined"!=typeof ScrollTrigger&&(gsap.registerPlugin(ScrollTrigger),document.querySelectorAll("[data-typewriter]").forEach(e=>{ScrollTrigger.create({trigger:e,start:"top 80%",once:!0,onEnter:()=>{!function(e,t=15){const n=(e.getAttribute("data-text")||e.textContent).split(""),r=e.offsetHeight,i=e.offsetWidth;e.style.minHeight=`${r}px`,e.style.minWidth=`${i}px`,e.style.display="inline-block",e.textContent="",e.style.visibility="visible";let o=0;setTimeout(function r(){if(o<n.length){e.textContent+=n[o],o++;const i=10*Math.random()-5;setTimeout(r,t+i)}},100)}(e,15)}})}))}),window.addEventListener("DOMContentLoaded",function(){if("undefined"==typeof gsap||"undefined"==typeof ScrollTrigger)return;const e=document.querySelector("[data-hero-title]");if(!e)return;const t=gsap.timeline({scrollTrigger:{trigger:e,start:"top 80%",once:!0}});gsap.set(e,{opacity:0,scale:1.2,filter:"brightness(0)"}),t.to(e,{opacity:1,filter:"brightness(3)",duration:.05}).to(e,{opacity:0,filter:"brightness(0)",duration:.03}).to(e,{opacity:1,filter:"brightness(3)",duration:.05}).to(e,{opacity:0,filter:"brightness(0)",duration:.03}).to(e,{opacity:1,filter:"brightness(3)",duration:.05}).to(e,{scale:1,filter:"brightness(1)",duration:.4,ease:"power2.out"}),gsap.fromTo(e,{opacity:1},{opacity:.4,duration:.7,repeat:-1,yoyo:!0,ease:"steps(1)",delay:2})}),document.addEventListener("DOMContentLoaded",()=>{"undefined"!=typeof gsap&&document.querySelectorAll("[data-pixel-burst]").forEach(e=>{e.addEventListener("click",e=>{!function(e,t){const n=["#ffff00","#ffaa00","#ff6600","#ffffff","#ffdd00"];for(let r=0;r<8;r++){const i=document.createElement("div"),o=45*r+(30*Math.random()-15),a=n[Math.floor(Math.random()*n.length)],s=Math.random()>.5?8:6;i.style.cssText=`\n          position: fixed;\n          width: ${s}px;\n          height: ${s}px;\n          background: ${a};\n          box-shadow: 0 0 4px ${a};\n          left: ${e}px;\n          top: ${t}px;\n          pointer-events: none;\n          z-index: 9999;\n        `,document.body.appendChild(i);const l=40+40*Math.random(),d=o*Math.PI/180;gsap.to(i,{x:Math.cos(d)*l,y:Math.sin(d)*l+20,opacity:0,scale:0,duration:.8,ease:"steps(8)",onComplete:()=>i.remove()})}}(e.clientX,e.clientY)})})}),(()=>{const e={storageKey:"emailGateSubmitted",expiryDays:7,hideDelay:4e3,animationDelay:300,triggerThreshold:.5,scrollThrottleMs:100},t={selector:".swiper-videos",navigation:{nextEl:'[data-swiper="next-video"]',prevEl:'[data-swiper="prev-video"]'},pagination:{el:'[data-swiper="pagination"]'},breakpoints:{478:{slidesPerView:1,spaceBetween:0},768:{slidesPerView:1,spaceBetween:0},992:{slidesPerView:1,spaceBetween:0}},slidesPerView:1,spaceBetween:0},n={selector:".swiper-cases",navigation:{nextEl:'[data-swiper="next-case"]',prevEl:'[data-swiper="prev-case"]'},pagination:{el:'[data-swiper="pagination-case"]'},breakpoints:{478:{slidesPerView:1,spaceBetween:16},768:{slidesPerView:1,spaceBetween:16},992:{slidesPerView:2,spaceBetween:16}},slidesPerView:1,spaceBetween:20};let r=null,i=!1;function o(e){const t={value:!0,expiry:(new Date).getTime()+24*e.expiryDays*60*60*1e3};try{return localStorage.setItem(e.storageKey,JSON.stringify(t)),!0}catch(n){return console.error("❌ Failed to save:",n),!1}}function a(e){if(void 0===window.Swiper)return null;const t=document.querySelector(e.selector);if(!t)return null;if("true"===t.dataset.swiperInitialized&&t.swiper)return t.swiper;const n={slidesPerView:e.slidesPerView,spaceBetween:e.spaceBetween,loop:!1,speed:600,navigation:{nextEl:e.navigation.nextEl,prevEl:e.navigation.prevEl,disabledClass:"is-disabled"},pagination:{el:e.pagination.el,clickable:!0,bulletClass:"swiper_bullet",bulletActiveClass:"is-active",renderBullet:(e,t)=>`<button class="${t}" aria-label="Slide ${e+1}"></button>`},breakpoints:e.breakpoints,keyboard:{enabled:!0},watchOverflow:!0},r=new window.Swiper(t,n);return t.dataset.swiperInitialized="true",r}function s(){const t=document.querySelector("[data-hero-section]"),n=document.querySelector("[data-email-gate]"),r=null==n?void 0:n.querySelector(".gate_form-block.w-form"),i=null==n?void 0:n.querySelector(".gate_sucess.w-form-done");if(!t||!n||!r)return void console.error("❌ Missing required elements");if(function(e){try{const t=localStorage.getItem(e.storageKey);if(!t)return!1;if("true"===t)return o(e),!0;const n=JSON.parse(t);return(new Date).getTime()>n.expiry?(localStorage.removeItem(e.storageKey),!1):!0===n.value}catch(t){return!1}}(e))return void(n.style.display="none");let a,s=0,l=!1,d=!1;n.style.display="none",window.showEmailGate=()=>{s=window.pageYOffset||document.documentElement.scrollTop,n.style.display="flex",document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${s}px`,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n.classList.add("active")})})},window.hideEmailGate=()=>{n.classList.remove("active"),setTimeout(()=>{n.style.display="none",document.body.style.removeProperty("overflow"),document.body.style.removeProperty("position"),document.body.style.removeProperty("width"),document.body.style.removeProperty("top"),window.scrollTo({top:s,behavior:"auto"})},e.animationDelay)},window.handleEmailSuccess=()=>{d||(d=!0,o(e),setTimeout(()=>{window.hideEmailGate()},e.hideDelay))};const u=new MutationObserver(()=>{if(d)return;const e=r.classList.contains("w-form-done"),t=!!i&&"none"!==window.getComputedStyle(i).display;(e||t)&&(window.handleEmailSuccess(),u.disconnect())});u.observe(r,{attributes:!0,attributeFilter:["style","class"]}),i&&u.observe(i,{attributes:!0,attributeFilter:["style","class"]});const c=()=>{if(d)return;const e=r.classList.contains("w-form-done"),t=!!i&&"none"!==window.getComputedStyle(i).display;(e||t)&&(window.handleEmailSuccess(),a&&clearInterval(a))},p=()=>{if(l)return;const n=t.getBoundingClientRect(),r=window.innerHeight*e.triggerThreshold;n.bottom<=r&&(l=!0,window.showEmailGate(),a=setInterval(c,300),window.removeEventListener("scroll",m),window.removeEventListener("wheel",m),window.removeEventListener("touchmove",m))},m=function(e,t){let n;return function(...r){n||(e.apply(this,r),n=!0,setTimeout(()=>{n=!1},t))}}(p,e.scrollThrottleMs);window.addEventListener("scroll",m,{passive:!0}),window.addEventListener("wheel",m,{passive:!0}),window.addEventListener("touchmove",m,{passive:!0}),p()}function l(){a(t),a(n)}function d(e=0){if(void 0!==window.Swiper)l(),r||"undefined"==typeof MutationObserver||(r=new MutationObserver(()=>{l()}),r.observe(document.body,{childList:!0,subtree:!0}));else{if(e>=10)return;setTimeout(()=>d(e+1),200)}}!function(){window.addEventListener("load",s);const e=()=>{i||(i=!0,d())};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.addEventListener("load",e)}()})();const e=()=>{const e=document.querySelectorAll("[data-bunny-player-init]");if(!e.length)return;const t=e=>e<10?`0${e}`:`${e}`,n=e=>{if(!Number.isFinite(e)||e<0)return"00:00";const n=Math.floor(e),r=Math.floor(n/3600),i=Math.floor(n%3600/60),o=n%60;return r>0?`${r}:${t(i)}:${t(o)}`:`${t(i)}:${t(o)}`},r=(e,t)=>{e.forEach(e=>{e.textContent=t})},i=e=>e&&e.length?e.reduce((e,t)=>(t.width||0)>(e.width||0)?t:e,e[0]):null,o=e=>{const t=e.play();t&&"function"==typeof t.then&&t.catch(()=>{})},a=(e,t)=>{t||"true"===e.getAttribute("data-player-activated")||"idle"!==e.getAttribute("data-player-status")||e.setAttribute("data-player-status","ready")},s=(e,t,n,r)=>{if("true"!==t||!n||!r)return;const i=e.querySelector("[data-player-before]");i&&(i.style.paddingTop=r/n*100+"%")},l=(e,t,n)=>{if("true"!==t)return;const r=e.querySelector("[data-player-before]");if(!r)return;!(r.style.paddingTop&&"0%"!==r.style.paddingTop)&&n.videoWidth&&n.videoHeight&&s(e,t,n.videoWidth,n.videoHeight)},d=(e,t)=>new Promise(n=>{if(t&&window.Hls&&Hls.isSupported())try{const t=new Hls,r={width:0,height:0,duration:Number.NaN};t.on(Hls.Events.MANIFEST_PARSED,(e,n)=>{const o=(null==n?void 0:n.levels)||t.levels||[],a=i(o);(null==a?void 0:a.width)&&a.height&&(r.width=a.width,r.height=a.height)}),t.on(Hls.Events.LEVEL_LOADED,(e,t)=>{(null==t?void 0:t.details)&&Number.isFinite(t.details.totalduration)&&(r.duration=t.details.totalduration)});const o=()=>{try{t.destroy()}catch(e){}n(r)};return t.on(Hls.Events.ERROR,o),t.on(Hls.Events.LEVEL_LOADED,o),void t.loadSource(e)}catch(o){return void n({width:0,height:0,duration:Number.NaN})}const r=e=>{let t=0;const n=/#EXTINF:([\\d.]+)/g;let r=n.exec(e);for(;null!==r;)t+=Number.parseFloat(r[1]),r=n.exec(e);return t};fetch(e,{credentials:"omit",cache:"no-store"}).then(e=>{if(!e.ok)throw new Error("master");return e.text()}).then(t=>{const i=(e=>{const t=e.split(/\r?\n/);let n=0,r=0,i=null,o=null;return t.forEach(e=>{if(e.startsWith("#EXT-X-STREAM-INF:"))o=e;else if(o&&e&&"#"!==e[0]){i||(i=e.trim());const t=/RESOLUTION=(\d+)x(\d+)/.exec(o);if(t){const e=Number.parseInt(t[1],10),i=Number.parseInt(t[2],10);e>n&&(n=e,r=i)}o=null}}),{bestWidth:n,bestHeight:r,media:i}})(t);if(!i.media)return void n({width:i.bestWidth||0,height:i.bestHeight||0,duration:Number.NaN});const a=((e,t)=>{try{return new URL(t,e).toString()}catch(o){return t}})(e,i.media);return fetch(a,{credentials:"omit",cache:"no-store"}).then(e=>{if(!e.ok)throw new Error("media");return e.text()}).then(e=>{n({width:i.bestWidth||0,height:i.bestHeight||0,duration:r(e)})})}).catch(()=>{n({width:0,height:0,duration:Number.NaN})})});e.forEach(e=>{const t=e.getAttribute("data-player-src"),u=e.querySelector("video");if(!t||!u)return;try{u.paused||u.pause()}catch(z){}if(u.src&&u.src!==t)try{u.removeAttribute("src"),u.load()}catch(z){}const c=t=>{e.getAttribute("data-player-status")!==t&&e.setAttribute("data-player-status",t)},p=t=>{u.muted=Boolean(t),e.setAttribute("data-player-muted",u.muted?"true":"false")},m=t=>{e.setAttribute("data-player-fullscreen",t?"true":"false")},f=t=>{e.setAttribute("data-player-activated",t?"true":"false")};e.hasAttribute("data-player-activated")||f(!1),e.hasAttribute("data-player-status")||c("idle");const v=e.querySelector("[data-player-timeline]"),w=e.querySelector("[data-player-progress]"),y=e.querySelector("[data-player-buffered]"),g=e.querySelector("[data-player-timeline-handle]"),h=e.querySelectorAll("[data-player-time-duration]"),b=e.querySelectorAll("[data-player-time-progress]"),E=e.getAttribute("data-player-update-size"),S=e.getAttribute("data-player-lazy"),L="true"===S,x="meta"===S,k="true"===e.getAttribute("data-player-autoplay"),A="true"===e.getAttribute("data-player-muted");let T=!1;k?(p(!0),u.loop=!0):p(A),u.setAttribute("muted",""),u.setAttribute("playsinline",""),u.setAttribute("webkit-playsinline",""),u.playsInline=!0,void 0!==u.disableRemotePlayback&&(u.disableRemotePlayback=!0),k&&(u.autoplay=!1);const M=Boolean(u.canPlayType("application/vnd.apple.mpegurl")),P=Boolean(window.Hls&&Hls.isSupported()&&!M);if("true"===E&&!x&&!L){const n=u.preload,r=()=>{s(e,E,u.videoWidth,u.videoHeight),u.removeEventListener("loadedmetadata",r),u.preload=n||""};u.preload="metadata",u.addEventListener("loadedmetadata",r,{once:!0}),u.src=t}let R=!1;const F=()=>{if(!R){if(R=!0,e._hls){try{e._hls.destroy()}catch(z){}e._hls=null}if(M)u.preload=L||x?"auto":u.preload,u.src=t,u.addEventListener("loadedmetadata",()=>{a(e,T),"true"===E&&s(e,E,u.videoWidth,u.videoHeight),h.length&&r(h,n(u.duration))},{once:!0});else if(P)try{const o=new Hls({maxBufferLength:10});o.attachMedia(u),o.on(Hls.Events.MEDIA_ATTACHED,()=>{o.loadSource(t)}),o.on(Hls.Events.MANIFEST_PARSED,()=>{if(a(e,T),"true"===E){const t=i(o.levels||[]);(null==t?void 0:t.width)&&t.height&&s(e,E,t.width,t.height)}}),o.on(Hls.Events.LEVEL_LOADED,(e,t)=>{(null==t?void 0:t.details)&&Number.isFinite(t.details.totalduration)&&h.length&&r(h,n(t.details.totalduration))}),o.on(Hls.Events.ERROR,(e,t)=>{if(console.error("❌ Bunny Player: HLS error",t),t.fatal)switch(t.type){case Hls.ErrorTypes.NETWORK_ERROR:console.error("❌ Bunny Player: Network error, trying to recover"),o.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.error("❌ Bunny Player: Media error, trying to recover"),o.recoverMediaError();break;default:console.error("❌ Bunny Player: Fatal error, destroying HLS"),o.destroy()}}),e._hls=o}catch(z){console.error("❌ Bunny Player: Error initializing HLS"),u.src=t}else u.src=t}};x?(d(t,P).then(t=>{t.width&&t.height&&s(e,E,t.width,t.height),h.length&&Number.isFinite(t.duration)&&t.duration>0&&r(h,n(t.duration)),a(e,T)}),u.preload="none"):L?u.preload="none":F();const H=()=>Boolean(document.fullscreenElement||document.webkitFullscreenElement),C=()=>{H()||u.webkitDisplayingFullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():u.webkitDisplayingFullscreen&&"function"==typeof u.webkitExitFullscreen&&u.webkitExitFullscreen():e.requestFullscreen?e.requestFullscreen():u.requestFullscreen?u.requestFullscreen():u.webkitSupportsFullscreen&&"function"==typeof u.webkitEnterFullscreen&&u.webkitEnterFullscreen()};document.addEventListener("fullscreenchange",()=>m(H())),document.addEventListener("webkitfullscreenchange",()=>m(H())),u.addEventListener("webkitbeginfullscreen",()=>m(!0)),u.addEventListener("webkitendfullscreen",()=>m(!1)),e.addEventListener("click",t=>{const n=t.target.closest("[data-player-control]");if(!n||!e.contains(n))return;const r=n.getAttribute("data-player-control");"play"===r||"pause"===r||"playpause"===r?u.paused||u.ended?(!L&&!x||R||F(),T=!0,c("loading"),o(u)):u.pause():"mute"===r?(u.muted=!u.muted,e.setAttribute("data-player-muted",u.muted?"true":"false")):"fullscreen"===r&&C()});const q=()=>{h.length&&r(h,n(u.duration)),b.length&&r(b,n(u.currentTime))};let I;u.addEventListener("timeupdate",q),u.addEventListener("loadedmetadata",()=>{q(),l(e,E,u)}),u.addEventListener("loadeddata",()=>l(e,E,u)),u.addEventListener("playing",()=>l(e,E,u)),u.addEventListener("durationchange",q);const O=()=>{if(!u.duration)return;const e=u.currentTime/u.duration*100;w&&(w.style.transform=`translateX(${e-100}%)`),g&&(g.style.left=`${e}%`)},D=()=>{O(),u.paused||u.ended||(I=requestAnimationFrame(D))},N=()=>{if(!y||!u.duration||!u.buffered.length)return;const e=u.buffered.end(u.buffered.length-1)/u.duration*100;y.style.transform=`translateX(${e-100}%)`};if(u.addEventListener("progress",N),u.addEventListener("loadedmetadata",N),u.addEventListener("durationchange",N),u.addEventListener("play",()=>{f(!0),cancelAnimationFrame(I),D(),c("playing")}),u.addEventListener("playing",()=>{T=!1,c("playing")}),u.addEventListener("pause",()=>{T=!1,cancelAnimationFrame(I),O(),c("paused")}),u.addEventListener("waiting",()=>{c("loading")}),u.addEventListener("canplay",()=>{a(e,T)}),u.addEventListener("ended",()=>{T=!1,cancelAnimationFrame(I),O(),c("paused"),f(!1)}),u.addEventListener("error",e=>{console.error("❌ Bunny Player: Video error",e),console.error("❌ Bunny Player: Error code:",u.error?u.error.code:"unknown"),console.error("❌ Bunny Player: Error message:",u.error?u.error.message:"unknown"),c("error")}),u.addEventListener("loadstart",()=>{c("loading")}),v){let t=!1,i=!1,a=0,s=0;const l=180;let d=null;const c=()=>{d=v.getBoundingClientRect()},p=e=>{d||c();let t=(e-d.left)/d.width;return t<0&&(t=0),t>1&&(t=1),t},m=e=>{if(!u.duration)return;const t=100*e;w&&(w.style.transform=`translateX(${t-100}%)`),g&&(g.style.left=`${t}%`),b.length&&r(b,n(e*u.duration))},f=e=>{!u.duration||e-s<l||(s=e,u.currentTime=a)},y=n=>{if(!u.duration)return;t=!0,i=!u.paused&&!u.ended,i&&u.pause(),e.setAttribute("data-timeline-drag","true"),c();const r=p(n.clientX);a=r*u.duration,m(r),f(performance.now()),v.setPointerCapture&&v.setPointerCapture(n.pointerId),window.addEventListener("pointermove",h,{passive:!1}),window.addEventListener("pointerup",E,{passive:!0}),n.preventDefault()},h=e=>{if(!t)return;const n=p(e.clientX);a=n*u.duration,m(n),f(performance.now()),e.preventDefault()},E=()=>{t&&(t=!1,e.setAttribute("data-timeline-drag","false"),d=null,u.currentTime=a,i?o(u):(O(),q()),window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",E))};v.addEventListener("pointerdown",y,{passive:!1}),g&&g.addEventListener("pointerdown",y,{passive:!1}),window.addEventListener("resize",()=>{t||(d=null)})}let $;const _=t=>{e.getAttribute("data-player-hover")!==t&&e.setAttribute("data-player-hover",t)},B=()=>{_("active"),clearTimeout($),$=setTimeout(()=>_("idle"),3e3)};e.addEventListener("pointerdown",B),document.addEventListener("fullscreenchange",B),document.addEventListener("webkitfullscreenchange",B);let V=!1;const W=t=>{const n=e.getBoundingClientRect();t.clientX>=n.left&&t.clientX<=n.right&&t.clientY>=n.top&&t.clientY<=n.bottom&&B()};if(e.addEventListener("pointerenter",()=>{B(),V||(V=!0,window.addEventListener("pointermove",W,{passive:!0}))}),e.addEventListener("pointerleave",()=>{_("idle"),clearTimeout($),V&&(V=!1,window.removeEventListener("pointermove",W))}),k){new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.intersectionRatio>0?(!L&&!x||R||F(),u.paused?(T=!0,c("loading"),o(u)):c("playing")):u.paused||u.ended||(u.pause(),c("paused"))})},{threshold:.1}).observe(e)}})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}();
